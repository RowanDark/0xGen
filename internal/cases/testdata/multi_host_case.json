{
  "version": "1.1",
  "id": "R6PZLFDP2I3ZMVL77GNI2FQT4U",
  "asset": {
    "kind": "web",
    "identifier": "c.internal",
    "details": "https://c.internal/metadata"
  },
  "vector": {
    "kind": "http_proxy"
  },
  "summary": "3 plugin signal(s) indicate an issue affecting c.internal (https://c.internal/metadata).\n\nKey evidence:\n- [Galdr] Open redirect observed (MED)\n- [Proxy] Captured authenticated flow (HIGH)\n- [Seer] Server-side request forgery (CRIT)",
  "evidence": [
    {
      "plugin": "galdr",
      "type": "galdr.redirect",
      "message": "Open redirect observed",
      "metadata": {
        "redirect_chain": "https://auth.example/login -\u003e https://app.example/dashboard -\u003e https://c.internal/metadata?token=abc123"
      }
    },
    {
      "plugin": "proxy",
      "type": "proxy.session",
      "message": "Captured authenticated flow",
      "metadata": {
        "cookie_domain": ".example.com",
        "param:token": "abc123"
      }
    },
    {
      "plugin": "seer",
      "type": "seer.ssrf",
      "message": "Server-side request forgery",
      "metadata": {
        "shared_param": "token=abc123"
      }
    }
  ],
  "proof": {
    "summary": "Reproduce the issue on c.internal by following 2 synthesised steps.",
    "steps": [
      "Review plugin evidence: You are an AI security analyst. Summarise why the following signals combine into a single case.\nAsset: c.internal (web)\nAttack vector: http_proxy\nEvidence:\n- Plugin=galdr Severity=MED Message=Open redirect observed\n- Plugin=proxy Severity=HIGH Message=Captured authenticated flow\n- Plugin=seer Severity=CRIT Message=Server-side request forgery\nProvide a concise narrative and highlight overlapping evidence.",
      "Execute reproduction instructions synthesised from prompt: Synthesize deterministic reproduction steps for asset c.internal (web).\nUse at most 4 steps. Incorporate plugin observations:\n- Galdr observed: Open redirect observed\n- Proxy observed: Captured authenticated flow\n- Seer observed: Server-side request forgery\nReturn concise imperative steps."
    ]
  },
  "risk": {
    "severity": "crit",
    "score": 9.5,
    "rationale": "Highest severity reported by contributing plugins: CRIT"
  },
  "confidence": 0.75,
  "confidence_log": "3 plugin(s), 3 finding(s)",
  "sources": [
    {
      "id": "01J123ABCEXAMPLE0000000002",
      "plugin": "galdr",
      "type": "galdr.redirect",
      "severity": "med",
      "target": "https://app.example/start"
    },
    {
      "id": "01J123ABCEXAMPLE0000000001",
      "plugin": "proxy",
      "type": "proxy.session",
      "severity": "high",
      "target": "https://auth.example/login"
    },
    {
      "id": "01J123ABCEXAMPLE0000000003",
      "plugin": "seer",
      "type": "seer.ssrf",
      "severity": "crit",
      "target": "https://c.internal/metadata"
    }
  ],
  "generated_at": "2023-11-15T03:46:40Z",
  "graph": {
    "dot": "digraph AttackChain {\n    rankdir=LR;\n    node [shape=box];\n    n0 [label=\"auth.example /login\"];\n    n1 [label=\"app.example /dashboard\"];\n    n2 [label=\"c.internal /metadata\"];\n    n0 -\u003e n1 [label=\"S1: Redirect from auth.example /login to app.example /dashboard (galdr)\"];\n    n1 -\u003e n2 [label=\"S2: Redirect from app.example /dashboard to c.internal /metadata (galdr)\"];\n    n0 -\u003e n2 [label=\"S3: Parameter token reused across hosts (seer)\"];\n}\n",
    "mermaid": "graph TD\n    auth_example__login[\"auth.example /login\"] --\u003e app_example__dashboard[\"app.example /dashboard\"] |S1: Redirect from auth.example /login to app.example /dashboard (galdr)|\n    app_example__dashboard[\"app.example /dashboard\"] --\u003e c_internal__metadata[\"c.internal /metadata\"] |S2: Redirect from app.example /dashboard to c.internal /metadata (galdr)|\n    auth_example__login[\"auth.example /login\"] --\u003e c_internal__metadata[\"c.internal /metadata\"] |S3: Parameter token reused across hosts (seer)|\n",
    "summary": "Correlated attack path spans 3 steps across 3 nodes: auth.example /login -\u003e app.example /dashboard -\u003e c.internal /metadata. Contributors: step 1 by galdr (galdr.redirect); step 2 by galdr (galdr.redirect); step 3 by seer (seer.ssrf)",
    "attack_path": [
      {
        "stage": 1,
        "from": "auth.example /login",
        "to": "app.example /dashboard",
        "description": "Redirect from auth.example /login to app.example /dashboard",
        "plugin": "galdr",
        "type": "galdr.redirect",
        "finding_id": "01J123ABCEXAMPLE0000000002",
        "severity": "med"
      },
      {
        "stage": 2,
        "from": "app.example /dashboard",
        "to": "c.internal /metadata",
        "description": "Redirect from app.example /dashboard to c.internal /metadata",
        "plugin": "galdr",
        "type": "galdr.redirect",
        "finding_id": "01J123ABCEXAMPLE0000000002",
        "severity": "med"
      },
      {
        "stage": 3,
        "from": "auth.example /login",
        "to": "c.internal /metadata",
        "description": "Parameter token reused across hosts",
        "plugin": "seer",
        "type": "seer.ssrf",
        "finding_id": "01J123ABCEXAMPLE0000000003",
        "severity": "crit"
      }
    ]
  }
}
